# chezmoi:template:left-delimiter="# [[" right-delimiter="]] #"
# This file contains all aliases used in the fish shell configuration

# Only load aliases in interactive shells
if not status is-interactive
    return
end

###########################################
# FILE SYSTEM ALIASES
###########################################

# Set up aliases for eza if installed
if type -q eza
    # Define common flags once to reduce repetition
    set -l eza_base "eza --group-directories-first --icons"
    set -l eza_long "eza -lah --group-directories-first --icons --git"

    # Basic listing aliases (most frequently used)
    alias ls="$eza_base"
    alias ll="eza -lh --group-directories-first --icons --git"
    alias la="$eza_long"

    # Tree view aliases
    alias lt="eza -T --group-directories-first --icons"
    alias ltt="eza -T --group-directories-first --icons --git --level=2"
    alias ltree="eza -T --group-directories-first --icons --git --level=3"

    # Git-focused aliases for developers
    alias lg="$eza_long --git-repos"
    alias lgit="$eza_long --git-repos --sort=modified"

    # Size and sorting aliases for data scientists
    alias lsize="$eza_long --sort=size --reverse"
    alias lmod="$eza_long --sort=modified --reverse"
    alias lext="$eza_long --sort=extension"

    # Research-friendly aliases
    alias lrecent="$eza_long --sort=modified --reverse --time-style=relative"
    alias ldetail="$eza_long --extended --time-style=long-iso"
    alias lsearch="$eza_long"

    # Recursive and filtering aliases
    alias lrec="eza -R --group-directories-first --icons --level=2"
    alias lcode="$eza_long -I='*.pyc|*.pyo|__pycache__|.DS_Store|node_modules|.git'"
    alias ldata="$eza_long --sort=size --reverse -I='*.log|*.tmp|.cache'"
end

# Use bat instead of cat if installed
if type -q bat
    # Set bat aliases - using smart_bat function defined in functions directory
    alias cat="smart_bat"
end

# Use fd instead of find if installed - optimize with base flags
if type -q fd
    alias find="fd"

    # Basic file search aliases (most frequently used)
    alias ff="fd --type f"                                    # Find files only
    alias fdir="fd --type d"                                  # Find directories only
    alias fexe="fd --type x"                                  # Find executables
    alias fempty="fd --type e"                                # Find empty files/dirs

    # Developer-focused search aliases - cache common extensions
    alias fcode="fd --type f -e py -e js -e ts -e rs -e go -e java -e cpp -e c -e h" # Code files
    alias fconfig="fd --type f -e json -e yaml -e yml -e toml -e ini -e conf"        # Config files
    alias fdocs="fd --type f -e md -e txt -e rst -e tex"                             # Documentation
    alias fdata="fd --type f -e csv -e json -e parquet -e xlsx -e h5 -e hdf5"       # Data files

    # Git and version control
    alias fgit="fd --type f --hidden --max-depth 3 -e git"   # Git-related files

    # Size and time-based search functions (configurable with defaults)
    function fbig
        set -l size_threshold (test (count $argv) -gt 0; and echo $argv[1]; or echo "+10m")
        fd --type f --size $size_threshold
    end

    function fsmall
        set -l size_threshold (test (count $argv) -gt 0; and echo $argv[1]; or echo "-1k")
        fd --type f --size $size_threshold
    end

    function frecent
        set -l time_period (test (count $argv) -gt 0; and echo $argv[1]; or echo "1d")
        fd --type f --changed-within $time_period
    end

    function fold
        set -l time_period (test (count $argv) -gt 0; and echo $argv[1]; or echo "30d")
        fd --type f --changed-before $time_period
    end

    # Advanced search patterns
    alias fhidden="fd --hidden --type f"                     # Include hidden files
    alias flink="fd --type l"                                # Find symlinks
    alias fdeep="fd --type f --max-depth 1"                  # Shallow search
    alias fpath="fd --full-path"                             # Search full paths
end

# Enhanced ripgrep aliases if installed - cache type check and use base flags
if type -q rg
    # Define base flags once to reduce repetition
    set -l rg_base "rg --smart-case --hidden"

    # Basic search aliases (most frequently used)
    alias rg="$rg_base"                      # Smart case + hidden files
    alias rgl="$rg_base -n"                 # With line numbers
    alias rgv="$rg_base -v"                 # Invert match

    # Context search aliases
    alias rgc="$rg_base -C 3"               # 3 lines context
    alias rgb="$rg_base -B 5"               # 5 lines before
    alias rga="$rg_base -A 5"               # 5 lines after

    # File type specific searches
    alias rgpy="$rg_base -tpy"              # Python files
    alias rgjs="$rg_base -tjs -tts"         # JavaScript/TypeScript
    alias rgrs="$rg_base -trust"            # Rust files
    alias rggo="$rg_base -tgo"              # Go files
    alias rgmd="$rg_base -tmd"              # Markdown files
    alias rgjson="$rg_base -tjson"          # JSON files
    alias rgyaml="$rg_base -tyaml"          # YAML files

    # Developer-focused searches
    alias rgcode="$rg_base -tpy -tjs -tts -trust -tgo -tjava -tcpp -tc" # Code files
    alias rgconfig="$rg_base -tjson -tyaml -ttoml"                      # Config files
    alias rglog="$rg_base -tlog"                                       # Log files

    # Pattern-based searches
    alias rgword="$rg_base -w"              # Whole word match
    alias rgtodo="$rg_base -i 'todo|fixme|hack|xxx'"                   # Code todos

    # Advanced search functions (configurable with defaults)
    function rgctx
        set -l context_lines (test (count $argv) -gt 1; and echo $argv[2]; or echo "3")
        command rg --smart-case --hidden -C $context_lines $argv[1]
    end

    # Replace functionality
    alias rgreplace="$rg_base --replace"    # Use with -r flag

    # Statistics and summary
    alias rgstats="$rg_base --stats"        # Show search statistics
    alias rgcount="$rg_base -c"             # Count matches per file
    alias rgfiles="$rg_base -l"             # List files with matches
end

###########################################
# GIT ALIASES
###########################################

# Set up git aliases
if type -q git
    alias g="git"
    alias gs="git status"
    alias ga="git add"
    alias gc="git commit"
    alias gp="git push"
    alias gl="git pull"
    alias gd="git diff"
    alias gco="git checkout"
    alias gb="git branch"
    alias glog="git log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
end

# GitHub CLI aliases if installed
if type -q gh
    alias ghpr="gh pr create"
    alias ghprv="gh pr view"
    alias ghprl="gh pr list"
end

###########################################
# SAFE DELETION ALIASES (RIP)
###########################################

# Use rip instead of rm for safer file deletion
if type -q rip
    alias rm="rip"                                              # Main rm replacement
    alias rmi="rip -i"                                          # Interactive deletion with info
    alias rmf="rip -f"                                          # Force deletion (non-interactive)
    alias rmls="rip -s"                                         # Show recently deleted files
    alias rmundo="rip -u"                                       # Restore last deleted file
    alias rminfo="rip -i"                                       # Show info before deleting
    alias rmgraveyard="rip graveyard"                           # Show graveyard location
    alias rmclean="rip -d"                                      # Permanently delete graveyard contents

    # Restore specific files function
    function rmrestore
        if test (count $argv) -eq 0
            echo "Usage: rmrestore <file1> [file2] ..."
            echo "Restores specified files from the graveyard"
            return 1
        end
        rip -u $argv
    end

    # Show what would be deleted without actually deleting
    function rmpreview
        if test (count $argv) -eq 0
            echo "Usage: rmpreview <file1> [file2] ..."
            echo "Shows information about files before deletion"
            return 1
        end
        rip -i $argv
    end
end

###########################################
# EDITOR ALIASES
###########################################

# Neovim aliases and setup
if type -q nvim
    alias vim="nvim"
    alias vi="nvim"
    alias v="nvim"
end

###########################################
# PROHIBITED SOFTWARE ALIASES
###########################################

# Block conda/miniconda/anaconda installation attempts
function conda
    echo "â›” Conda is not allowed in this environment."
    echo "Please use alternative Python environment tools like venv, virtualenv, or uv."
    echo "See $HOME/.local/share/conda_warning.txt for more information."
    return 1
end

function miniconda
    conda
end

function anaconda
    conda
end

###########################################
# CHEZMOI ALIASES
###########################################

# Chezmoi aliases for editing and merging config files with auto-apply
alias confedit="chezmoi edit --apply"
alias confmerge="chezmoi merge --apply"
